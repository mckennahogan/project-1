---
title: "McKenna Analysis - Percentile and Basic "
author: "McKenna Hogan"
date: '2022-11-17'
output: pdf_document
---

```{r libraries}
library(tidyverse)
library(knitr)
library(dplyr)
```

```{r data}
#skewed data
diab.data1<- read_csv("~/STAT400/Project 1/data/diabetes_012_health_indicators_BRFSS2015.csv")
#unskewed data
diab.data2<- 
  read_csv("~/STAT400/Project 1/data/diabetes_binary_5050split_health_indicators_BRFSS2015.csv")
diab.data3<- read_csv("~/STAT400/Project 1/data/diabetes_binary_health_indicators_BRFSS2015.csv")

nodiab.only.1<-diab.data1|>
  filter(Diabetes_012==0)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
prediab.only.1<-diab.data1|>
  filter(Diabetes_012==1)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
diab.only.1<-diab.data1|>
  filter(Diabetes_012==2)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
```

```{r percentile bootstrap func}
#income, bmi, genhealth, bp, anyhealthcare

# set up the bootstrap
# B <- 1000
# n <- nrow(law)
# theta_hat_star <- numeric(B) # storage
# 
# for(b in seq_len(B)) {
#   ## Your Turn: Do the bootstrap!
#   #get bootstrap dataset
#   idx_star<-sample(seq_len(n),n,replace = T)
#   x_star<-law[idx_star,]
#   
#   #computing teh statistic
#   theta_hat_star[b]<-cor(x_star$lsat,x_star$gpa)
# }
#pull size n, m times
percentile_bootstrap<-function(data,n,m){
  for (b in seq_len(m)){
    which.col<-sample(seq_len(n),n,replace=T)
    bootstrap.reps<-data[which.col,]
  }
  mean.HighBP<-rep(NA,m)
  mean.HighChol<-rep(NA,m)
  mean.BMI<-rep(NA,m)
  mean.AnyHealthcare<-rep(NA,m)
  mean.GenHlth<-rep(NA,m)
  mean.Income<-rep(NA,m)
  for(i in 1:m){
    start_i<-n*(i-1)+1
    end_i<-n*i
    mean.HighBP<-mean(bootstrap.reps$HighBP[start_i:end_i])
    mean.HighChol<-mean(bootstrap.reps$HighChol[start_i:end_i])
    mean.BMI<-mean(bootstrap.reps$BMI[start_i:end_i])
    mean.AnyHealthcare<-mean(bootstrap.reps$AnyHealthcare[start_i:end_i])
    mean.GenHlth<-mean(bootstrap.reps$GenHlth[start_i:end_i])
    mean.Income<-mean(bootstrap.reps$Income[start_i:end_i])
  }
  CI.HighBP<-rep(NA,m)
  CI.HighChol<-rep(NA,m)
  CI.BMI<-rep(NA,m)
  CI.AnyHealthcare<-rep(NA,m)
  CI.GenHlth<-rep(NA,m)
  CI.Income<-rep(NA,m)
  for(i in 1:m){
    start_i<-n*(i-1)+1
    end_i<-n*i
    CI.HighBP<-quantile(bootstrap.reps$HighBP[start_i:end_i],c(.025,.975))
    CI.HighChol<-quantile(bootstrap.reps$HighChol[start_i:end_i],c(.025,.975))
    CI.BMI<-quantile(bootstrap.reps$BMI[start_i:end_i],c(.025,.975))
    CI.AnyHealthcare<-quantile(bootstrap.reps$AnyHealthcare[start_i:end_i],c(.025,.975))
    CI.GenHlth<-quantile(bootstrap.reps$GenHlth[start_i:end_i],c(.025,.975))
    CI.Income<-quantile(bootstrap.reps$Income[start_i:end_i],c(.025,.975))
  }
  
  return(bootstrap.reps)
}
```

```{r returning percentile bootstrap data}
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)
percentile.n5.m10<-percentile_bootstrap(diab.only.1,5,10)

```

```{r}
basic_bootstrap<-function(data,B){
  
}
```

