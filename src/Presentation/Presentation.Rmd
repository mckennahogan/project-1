---
title: "Bootstrapping Diabetes Data to Illuminate Factors"
author: "Jorie Alvis, McKenna Hogan, Cadeon Ott"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
---

```{r libraries, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(knitr)
library(dplyr)
library(simpleboot)
library(boot) 
library(kableExtra)
library(patchwork)

set.seed(400)
```

## Dataset Overview {.columns-2 .smaller}

We got our dataset from kaggle:

The dataset consisted of health indicators for people with no diabetes, prediabetes, and diabetes.

We chose to work with the varibles HighBP, HighChol, BMI, AnyHealthcare, GenHlth, and Income

High BP, HighChol, and AnyHealthcare were binary while the others werent.

We decided to bootstrap our data because there was a massive difference in sample sizes for the 3 groups of people

Each of us did a different kind of bootsrapping method

```{r data, message=FALSE, warning=FALSE, include=FALSE}
#skewed data
diab.data1<- read_csv("~/STAT400/Project 1/data/diabetes_012_health_indicators_BRFSS2015.csv")
#unskewed data
diab.data2<- 
  read_csv("~/STAT400/Project 1/data/diabetes_binary_5050split_health_indicators_BRFSS2015.csv")
diab.data3<- read_csv("~/STAT400/Project 1/data/diabetes_binary_health_indicators_BRFSS2015.csv")

nodiab.only.1<-diab.data1|>
  filter(Diabetes_012==0)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
prediab.only.1<-diab.data1|>
  filter(Diabetes_012==1)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
diab.only.1<-diab.data1|>
  filter(Diabetes_012==2)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
```

<div style="float: right">
```{r echo=FALSE, fig.height=4, fig.width=4, message=FALSE, warning=FALSE}
ggplot(data=diab.data1)+
  geom_bar(aes(x=Diabetes_012), fill="blue")+
  labs(x="indicator",title="Diabetes Data")
```



# McKenna
```{r data, message=FALSE, warning=FALSE, include=FALSE}
#skewed data
diab.data1<- read_csv("~/STAT400/Project 1/data/diabetes_012_health_indicators_BRFSS2015.csv")
#unskewed data
diab.data2<- 
  read_csv("~/STAT400/Project 1/data/diabetes_binary_5050split_health_indicators_BRFSS2015.csv")
diab.data3<- read_csv("~/STAT400/Project 1/data/diabetes_binary_health_indicators_BRFSS2015.csv")

nodiab.only.1<-diab.data1|>
  filter(Diabetes_012==0)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
prediab.only.1<-diab.data1|>
  filter(Diabetes_012==1)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
diab.only.1<-diab.data1|>
  filter(Diabetes_012==2)|>
  select(HighBP,HighChol,BMI,AnyHealthcare,GenHlth,Income)
```

```{r new function data, message=FALSE, warning=FALSE, include=FALSE}

HighBP0<-nodiab.only.1$HighBP
HighBP1<-prediab.only.1$HighBP
HighBP2<-diab.only.1$HighBP

HighChol0<-nodiab.only.1$HighChol
HighChol1<-prediab.only.1$HighChol
HighChol2<-diab.only.1$HighChol

BMI0<-nodiab.only.1$BMI
BMI1<-prediab.only.1$BMI
BMI2<-diab.only.1$BMI

AnyHealthcare0<-nodiab.only.1$AnyHealthcare
AnyHealthcare1<-prediab.only.1$AnyHealthcare
AnyHealthcare2<-diab.only.1$AnyHealthcare

GenHlth0<-nodiab.only.1$GenHlth
GenHlth1<-prediab.only.1$GenHlth
GenHlth2<-diab.only.1$GenHlth

Income0<-nodiab.only.1$Income
Income1<-prediab.only.1$Income
Income2<-diab.only.1$Income

```

```{r function, message=FALSE, warning=FALSE, include=FALSE}
diff.means<-function(data0,data1,data2,R){
  
  
  no_pre<- two.boot(data0, data1, "mean", R = R)
  pre_diab<- two.boot(data1, data2, "mean", R = R)
  diab_no<- two.boot(data2, data0, "mean", R = R)
  
  se.no_pre<-sd(no_pre$t)
  se.pre_diab<-sd(pre_diab$t)
  se.diab_no<-sd(diab_no$t)
  
  bias.no_pre<-rep(NA,R)
  bias.pre_diab<-rep(NA,R)
  bias.diab_no<-rep(NA,R)
  for (i in 1:R){
    bias.no_pre[i]<-no_pre$t[i]-no_pre$t0
    bias.pre_diab[i]<-pre_diab$t[i]-pre_diab$t0
    bias.diab_no[i]<-diab_no$t[i]-diab_no$t0
  }
  bias.no_pre<-mean(bias.no_pre)
  bias.pre_diab<-mean(bias.pre_diab)
  bias.diab_no<-mean(bias.diab_no)
  
  boot.no_pre<-boot.ci(no_pre,type=c("perc","basic"))
  boot.pre_diab<-boot.ci(pre_diab,type=c("perc","basic"))
  boot.diab_no<-boot.ci(diab_no,type=c("perc","basic"))
  
  plot.no_pre<-ggplot() +
    geom_histogram(aes(no_pre$t), fill="darkgoldenrod1") +
    geom_segment(aes(y=25,yend=25,x=boot.no_pre$percent[4],
                     xend=boot.no_pre$percent[5], col="percentile"),size=1.5)+
    geom_segment(aes(y=35,yend=35,x=boot.no_pre$basic[4],
                     xend=boot.no_pre$basic[5],col="basic"),size=1.5)+
    xlab("mean(no diabetes) - mean(prediabetes)")
  
  plot.pre_diab<-ggplot() +
    geom_histogram(aes(pre_diab$t),fill="deepskyblue") +
    geom_segment(aes(y=25,yend=25,x=boot.pre_diab$percent[4],
                     xend=boot.pre_diab$percent[5], col="percentile"),size=1.5)+
    geom_segment(aes(y=35,yend=35,x=boot.pre_diab$basic[4],
                     xend=boot.pre_diab$basic[5],col="basic"),size=1.5)+
    xlab("mean(prediabetes) - mean(diabetes)")
  plot.diab_no<-ggplot() +
    geom_histogram(aes(diab_no$t),fill="coral") +
    geom_segment(aes(y=25,yend=25,x=boot.diab_no$percent[4],
                     xend=boot.diab_no$percent[5], col="percentile"),size=1.5)+
    geom_segment(aes(y=35,yend=35,x=boot.diab_no$basic[4],
                     xend=boot.diab_no$basic[5],col="basic"),size=1.5)+
    xlab("mean(diabetes) - mean(no diabetes)")

  mean.no_pre<-mean(no_pre$t)
  mean.pre_diab<-mean(pre_diab$t)
  mean.diab_no<-mean(diab_no$t)
  return(list(plot.no_pre, boot.no_pre,
              plot.pre_diab, boot.pre_diab,
              plot.diab_no, boot.diab_no,
              mean.no_pre,mean.pre_diab,mean.diab_no))
}

```

```{r calling each variable, message=FALSE, warning=FALSE, include=FALSE, cache=T}
HighBP.list<-diff.means(HighBP0,HighBP1,HighBP2,1000)

HighChol.list<-diff.means(HighChol0,HighChol1,HighChol2,1000)

BMI.list<-diff.means(BMI0,BMI1,BMI2,1000)

AnyHealthcare.list<-diff.means(AnyHealthcare0,AnyHealthcare1,AnyHealthcare2,1000)

GenHlth.list<-diff.means(GenHlth0,GenHlth1,GenHlth2,1000)

Income.list<-diff.means(Income0,Income1,Income2,1000)

```


```{r message=FALSE, warning=FALSE, include=FALSE}
no_pre.row1<-c(HighBP.list[[7]],HighBP.list[[2]][["percent"]][[4]],
              HighBP.list[[2]][["percent"]][[5]],
        HighBP.list[[2]][["basic"]][[4]],HighBP.list[[2]][["basic"]][[5]])
no_pre.row2<-c(HighChol.list[[7]],HighChol.list[[2]][["percent"]][[4]],
        HighChol.list[[2]][["percent"]][[5]],
        HighChol.list[[2]][["basic"]][[4]],HighChol.list[[2]][["basic"]][[5]])
no_pre.row3<-c(BMI.list[[7]],BMI.list[[2]][["percent"]][[4]],BMI.list[[2]][["percent"]][[5]],
        BMI.list[[2]][["basic"]][[4]],BMI.list[[2]][["basic"]][[5]])
no_pre.row4<-c(AnyHealthcare.list[[7]],AnyHealthcare.list[[2]][["percent"]][[4]],
        AnyHealthcare.list[[2]][["percent"]][[5]],
        AnyHealthcare.list[[2]][["basic"]][[4]],AnyHealthcare.list[[2]][["basic"]][[5]])
no_pre.row5<-c(GenHlth.list[[7]],GenHlth.list[[2]][["percent"]][[4]],
        GenHlth.list[[2]][["percent"]][[5]],
        GenHlth.list[[2]][["basic"]][[4]],GenHlth.list[[2]][["basic"]][[5]])
no_pre.row6<-c(Income.list[[7]],Income.list[[2]][["percent"]][[4]],
               Income.list[[2]][["percent"]][[5]],
        Income.list[[2]][["basic"]][[4]],Income.list[[2]][["basic"]][[5]])

no_pre.table<-rbind(no_pre.row1,no_pre.row2,no_pre.row3,no_pre.row4,no_pre.row5,no_pre.row6)
rownames(no_pre.table)<-c("HighBP","HighChol","BMI","AnyHealthcare","GenHlth","Income")
colnames(no_pre.table)<-c("mean","low percentile","high percentile","low basic","high basic")
no_pre.kable<-kable(no_pre.table,caption="no-pre",
                    digits=3,format="html",align="c")|>
  kable_paper("hover", full_width = F)

##

pre_diab.row1<-c(HighBP.list[[8]],HighBP.list[[2]][["percent"]][[4]],
              HighBP.list[[4]][["percent"]][[5]],
        HighBP.list[[2]][["basic"]][[4]],HighBP.list[[2]][["basic"]][[5]])
pre_diab.row2<-c(HighChol.list[[8]],HighChol.list[[4]][["percent"]][[4]],
        HighChol.list[[4]][["percent"]][[5]],
        HighChol.list[[4]][["basic"]][[4]],HighChol.list[[4]][["basic"]][[5]])
pre_diab.row3<-c(BMI.list[[8]],BMI.list[[4]][["percent"]][[4]],BMI.list[[4]][["percent"]][[5]],
        BMI.list[[4]][["basic"]][[4]],BMI.list[[4]][["basic"]][[5]])
pre_diab.row4<-c(AnyHealthcare.list[[8]],AnyHealthcare.list[[4]][["percent"]][[4]],
        AnyHealthcare.list[[4]][["percent"]][[5]],
        AnyHealthcare.list[[4]][["basic"]][[4]],AnyHealthcare.list[[2]][["basic"]][[5]])
pre_diab.row5<-c(GenHlth.list[[8]],GenHlth.list[[2]][["percent"]][[4]],
        GenHlth.list[[4]][["percent"]][[5]],
        GenHlth.list[[4]][["basic"]][[4]],GenHlth.list[[4]][["basic"]][[5]])
pre_diab.row6<-c(Income.list[[8]],Income.list[[4]][["percent"]][[4]],
               Income.list[[4]][["percent"]][[5]],
        Income.list[[4]][["basic"]][[4]],Income.list[[4]][["basic"]][[5]])

pre_diab.table<-rbind(pre_diab.row1,pre_diab.row2,pre_diab.row3,
                      pre_diab.row4,pre_diab.row5,pre_diab.row6)
rownames(pre_diab.table)<-c("HighBP","HighChol","BMI","AnyHealthcare","GenHlth","Income")
colnames(pre_diab.table)<-c("mean","low percentile","high percentile","low basic","high basic")
pre_diab.kable<-kable(pre_diab.table,caption="pre-diab",
                    digits=3,format="html",align="c")|>
  kable_paper("hover", full_width = F)

##

diab_no.row1<-c(HighBP.list[[9]],HighBP.list[[6]][["percent"]][[4]],
              HighBP.list[[6]][["percent"]][[5]],
        HighBP.list[[6]][["basic"]][[4]],HighBP.list[[6]][["basic"]][[5]])
diab_no.row2<-c(HighChol.list[[9]],HighChol.list[[6]][["percent"]][[4]],
        HighChol.list[[6]][["percent"]][[5]],
        HighChol.list[[6]][["basic"]][[4]],HighChol.list[[6]][["basic"]][[5]])
diab_no.row3<-c(BMI.list[[9]],BMI.list[[6]][["percent"]][[4]],BMI.list[[6]][["percent"]][[5]],
        BMI.list[[6]][["basic"]][[4]],BMI.list[[6]][["basic"]][[5]])
diab_no.row4<-c(AnyHealthcare.list[[9]],AnyHealthcare.list[[6]][["percent"]][[4]],
        AnyHealthcare.list[[6]][["percent"]][[5]],
        AnyHealthcare.list[[6]][["basic"]][[4]],AnyHealthcare.list[[6]][["basic"]][[5]])
diab_no.row5<-c(GenHlth.list[[9]],GenHlth.list[[6]][["percent"]][[4]],
        GenHlth.list[[6]][["percent"]][[5]],
        GenHlth.list[[6]][["basic"]][[4]],GenHlth.list[[6]][["basic"]][[5]])
diab_no.row6<-c(Income.list[[9]],Income.list[[6]][["percent"]][[4]],
               Income.list[[2]][["percent"]][[5]],
        Income.list[[6]][["basic"]][[4]],Income.list[[6]][["basic"]][[5]])

diab_no.table<-rbind(diab_no.row1,diab_no.row2,diab_no.row3,diab_no.row4,
                     diab_no.row5,diab_no.row6)
rownames(diab_no.table)<-c("HighBP","HighChol","BMI","AnyHealthcare","GenHlth","Income")
colnames(diab_no.table)<-c("mean","low percentile","high percentile","low basic","high basic")
diab_no.kable<-kable(diab_no.table,caption="diab-no",
                    digits=3,format="html",align="c")|>
  kable_paper("hover", full_width = F)

```


## Percentile and Basic Bootstraps

- I analyzed the variables HighBP, HighChol, BMI, AnyHealthcare, GenHlth, 
and Income for differences in means among no diabetes, prediabetes, and diabetes.

- Overall, I found that there was a significant difference in most of the means. The only
means that i didn't see a difference in were some of the AnyHealthcare CI's 

- There was small difference between the CI's for the percentile and basic bootstraps
which matched my findings for small bias


## Tables for means and CI's no - pre
```{r echo=FALSE, fig.height=4, fig.width=3, message=FALSE, warning=FALSE}
no_pre.kable
```
## Tables for means and CI's pre - diab
```{r echo=FALSE, fig.height=4, fig.width=3, message=FALSE, warning=FALSE}
pre_diab.kable
```
## Tables for means and CI's diab - no
```{r echo=FALSE, fig.height=4, fig.width=3, message=FALSE, warning=FALSE}
diab_no.kable
```

## AnyHealthcare No Diabetes and Prediabetes {.columns-2 .smaller}
<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
AnyHealthcare.list[2]
```

<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE, fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
AnyHealthcare.list[1]
```

## AnyHealthcare Prediabetes and Diabetes {.columns-2 .smaller}
<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
AnyHealthcare.list[4]
```
<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE,fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
AnyHealthcare.list[3]
```


## AnyHealthcare Diabetes and No Diabetes {.columns-2 .smaller}

<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
AnyHealthcare.list[6]
```
<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE, fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
AnyHealthcare.list[5]
```



## Income No Diabetes and Prediabetes {.columns-2 .smaller}

<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
HighBP.list[2]
```

<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE, fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
HighBP.list[1]
```

## Income Prediabetes and Diabetes {.columns-2 .smaller}
<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
HighBP.list[4]
```
<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE, fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
HighBP.list[3]
```


## Income Diabetes and No Diabetes {.columns-2 .smaller}

<div style="float: left">
```{r echo=FALSE, message=FALSE, warning=FALSE}
HighBP.list[6]
```
<div style="float: left">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE,fig.height=3, fig.width=4, message=FALSE, warning=FALSE}
HighBP.list[5]
```

# Jorie


```{r JorDataInit, message=FALSE, warning=FALSE, include=FALSE}
# This data has three classes
## No-diabetes: Most observations
## Pre-diabetes: Least observations
## Diabetes: Response of importance
data.main = read_csv("../../data/diabetes_012_health_indicators_BRFSS2015.csv")
data.main = data.main %>% rename("Diabetes"="Diabetes_012")

# Binary Classification
## Same number of observations for no-diabetes and pre-diabetes/diabetes
data.balanced = read_csv("../../data/diabetes_binary_5050split_health_indicators_BRFSS2015.csv")
data.balanced = data.balanced %>% rename("Diabetes"="Diabetes_binary")

# Binary Classification
## More observations of no-diabetes than pre-diabetes/diabetes
data.binary = read_csv("../../data/diabetes_binary_health_indicators_BRFSS2015.csv")
data.binary = data.binary %>% rename("Diabetes"="Diabetes_binary")
```

```{r JorFuncs, message=FALSE, warning=FALSE, include=FALSE}
bootSample = function(data, m, n) {
  ret = list()
  for (i in 1:m) {
    sample.no_d = sample(1:length(data[data$Diabetes == 0,]), size=n, replace=TRUE)
    data.sample.no_d = data[data$Diabetes == 0,][sample.no_d,]
    
    sample.pre_d = sample(1:length(data[data$Diabetes == 1,]), size=n, replace=TRUE)
    data.sample.pre_d = data[data$Diabetes == 1,][sample.pre_d,]
    
    sample.d = sample(1:length(data[data$Diabetes == 2,]), size=n, replace=TRUE)
    data.sample.d = data[data$Diabetes == 2,][sample.d,]
    
    data.sample = rbind(data.sample.no_d, data.sample.pre_d, data.sample.d)
    
    ret[[i]] = data.sample
  }
  
  return(ret)
}

normal_boot = function(data_list, factors) {
  # For each factor of interest
  ret = list()
  for (col_name in factors) {
    # For no, pre, and diabetes
    combo = list()
    for (d in 0:2) {
      data.stats = setNames(data.frame(matrix(ncol = 4, nrow = length(data_list))),
                            c("mean", "sd", "lower", "upper"))
      # For each sample
      for (i in 1:length(data_list)) {
        data.sample = data_list[[i]] %>% filter(Diabetes==d) %>% pull(col_name)
        
        data.mean = mean(data.sample)
        data.sd = sd(data.sample)
        
        delta = pnorm((1-0.95/2))*data.sd
        data.lower = data.mean-delta
        data.upper = data.mean+delta
        
        data.stats[i,] = c(data.mean, data.sd, data.lower, data.upper)
      }
      theta.hat = mean(data.stats$mean)
      theta.se = sd(data.stats$mean)
      
      delta = pnorm((1-0.95/2))*theta.se
      theta.lower = theta.hat-delta
      theta.upper = theta.hat+delta
      
      data.stats[length(data_list)+1,] = c(theta.hat, theta.se, theta.lower, theta.upper)
      
      combo[[d+1]] = data.stats
    }
    ret[[col_name]] = combo
  }
  return(ret)
}

student_t_boot = function(data_list, factors) {
  # For each factor of interest
  ret = list()
  for (col_name in factors) {
    # For no, pre, and diabetes
    combo = list()
    for (d in 0:2) {
      # Theta hat for the whole dataset
      data.theta_hat = mean(data.main %>% filter(Diabetes==d) %>% pull(col_name))
      
      data.stats = setNames(data.frame(matrix(ncol = 5, nrow = length(data_list))),
                            c("mean", "se", "t_stat", "lower", "upper"))
      # For each sample
      for (i in 1:length(data_list)) {
        data.sample = data_list[[i]] %>% filter(Diabetes==d) %>% pull(col_name)
        
        # re-sampled data
        data.resample = data.frame(matrix(ncol=length(data.sample)+1, nrow=length(data_list)))
        for (r in 1:length(data_list)){
          resample = sample(data.sample, size=length(data.sample), replace=TRUE)
          data.resample[r,] = cbind(resample, mean(resample))
        }
        data.mean = mean(data.sample)
        data.se = sd(data.resample[,length(data.sample)+1])
        
        data.t_stat = (data.mean-data.theta_hat)/data.se
        
        data.stats[i,] = c(data.mean, data.se, data.t_stat, NA, NA)
      }
      theta.hat = mean(data.stats$mean)
      theta.se = sd(data.stats$mean)
      
      theta.t_stat = (theta.hat-data.theta_hat)/theta.se
      
      theta.lower = theta.hat-abs(quantile(data.stats$t_stat, probs=c(0.05/2))*theta.se)
      theta.upper = theta.hat+abs(quantile(data.stats$t_stat, probs=c(1-0.05/2))*theta.se)
      
      data.stats[length(data_list)+1,] = c(theta.hat, theta.se, theta.t_stat,
                                           theta.lower, theta.upper)
      
      combo[[d+1]] = data.stats
    }
    ret[[col_name]] = combo
  }
  return(ret)
}
```

```{r JorAnalysisInit, message=FALSE, warning=FALSE, cache=TRUE, include=FALSE}
# The "m"s we are testing
m_list = c(10,30,50,100,250)
# The "n"s we are testing
n_list = c(10,25,75,125,250)
# Factors of interest
factors_list = c("Income", "BMI", "GenHlth", "HighBP", "AnyHealthcare")

ALL_DATA_norm = list(list(), list(), list(), list(), list())
ALL_DATA_stud = list(list(), list(), list(), list(), list())
for (i in 1:5) {
  m = m_list[i]
  for (j in 1:5) {
    n = n_list[j]
    
    boot_data = bootSample(data.main, m, n)
    ALL_DATA_norm[[i]][[j]] = normal_boot(boot_data, factors_list)
    ALL_DATA_stud[[i]][[j]] = student_t_boot(boot_data, factors_list)
  }
}
```

## Standard Normal Bootstrap CI

 - We used a Standard Normal Bootstrap for each classification, (No Diabetes, Pre-Diabetes, and Diabetes), and pulled out our factors of interest, (Income, BMI, GenHlth, HighBP, and AnyHealthcare).

 - We also used different values of sample size, `n`, and number of samples, `m`, to showcase the power of bootstrapping with Normal distributions

## Pairs of `m` and `n` values
Tables of standard error of our estimators

```{r echo=FALSE, message=FALSE, warning=FALSE}
pos_list = c("float_left", "float_left", "left")
title_list = c("No Diabetes", "Pre-Diabetes", "Diabetes")

TABLES_norm = list()
TABLES_stud = list()
for (factor.name in factors_list) {
  for (d in 1:3) {
    MEANS_norm = matrix(nrow=5,ncol=5)
    MEANS_stud = matrix(nrow=5,ncol=5)
    SE_norm = matrix(nrow=5,ncol=5)
    SE_stud = matrix(nrow=5,ncol=5)
    for (i in 1:5) {
      for (j in 1:5) {
        MEANS_norm[i,j] = tail(ALL_DATA_norm[[i]][[j]][[factor.name]][[d]]$mean,1)
        MEANS_stud[i,j] = tail(ALL_DATA_stud[[i]][[j]][[factor.name]][[d]]$mean,1)
        SE_norm[i,j] = tail(ALL_DATA_norm[[i]][[j]][[factor.name]][[d]]$sd,1)
        SE_stud[i,j] = tail(ALL_DATA_stud[[i]][[j]][[factor.name]][[d]]$se,1)
      }
    }
    t_title = paste(factor.name, title_list[d], sep=" and ")
    
    # Tables for standard normal
    ############################
    rownames(SE_norm) = paste("m=",m_list,sep="")
    colnames(SE_norm) = paste("n=",n_list,sep="")
    
    means_norm_table = kable(SE_norm, caption=t_title, digits=3, format = "html") %>%
      kable_styling(full_width=F, position=pos_list[d], font_size=8) %>%
      row_spec(0, bold=T, font_size=14) %>% row_spec(0:5, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "3.5em") %>%
      column_spec(2:6, width = "1em") %>% row_spec(c(1,3,5), color="white", background="grey")
    
    TABLES_norm[[factor.name]][[d]] = means_norm_table
    
    # Tables for student t normal
    ############################
    rownames(SE_stud) = paste("m=",m_list,sep="")
    colnames(SE_stud) = paste("n=",n_list,sep="")
    
    means_stud_table = kable(SE_stud, caption=t_title, digits=3, format = "html") %>%
      kable_styling(full_width=F, position=pos_list[d], font_size=8) %>%
      row_spec(0, bold=T, font_size=14) %>% row_spec(0:5, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "3.5em") %>%
      column_spec(2:6, width = "1em") %>% row_spec(c(1,3,5), color="white", background="grey")
    
    TABLES_stud[[factor.name]][[d]] = means_stud_table
  }
}
TABLES_norm[["Income"]][[1]]
TABLES_norm[["Income"]][[2]]
TABLES_norm[["Income"]][[3]]

TABLES_norm[["HighBP"]][[1]]
TABLES_norm[["HighBP"]][[2]]
TABLES_norm[["HighBP"]][[3]]

TABLES_norm[["AnyHealthcare"]][[1]]
TABLES_norm[["AnyHealthcare"]][[2]]
TABLES_norm[["AnyHealthcare"]][[3]]
```

## Bootstrap t CI

 - We used Student-t Bootstraping for each classification, (No Diabetes, Pre-Diabetes, and Diabetes), and pulled out our factors of interest, (Income, BMI, GenHlth, HighBP, and AnyHealthcare).

 - We also used different values of sample size, `n`, and number of samples, `m`, to showcase the difference of double bootstrapping with Student-t distributions
 
 - We wanted to show that larger and more samples decreased our standard error of our estimator

```{r message=FALSE, warning=FALSE, include=FALSE}
BOOT.norm = ALL_DATA_norm[[5]][[5]]
BOOT.stud = ALL_DATA_stud[[5]][[5]]
```

## Pairs of `m` and `n` values
Tables of standard error of our estimators

```{r echo=FALSE, message=FALSE, warning=FALSE}
TABLES_stud[["Income"]][[1]]
TABLES_stud[["Income"]][[2]]
TABLES_stud[["Income"]][[3]]

TABLES_stud[["HighBP"]][[1]]
TABLES_stud[["HighBP"]][[2]]
TABLES_stud[["HighBP"]][[3]]

TABLES_stud[["AnyHealthcare"]][[1]]
TABLES_stud[["AnyHealthcare"]][[2]]
TABLES_stud[["AnyHealthcare"]][[3]]
```

## Income

```{r echo=FALSE, message=FALSE, warning=FALSE}
### Tables for m=250, n=250 ###
# Normal CI table
norm_income_table = rbind("No Diabetes"=tail(BOOT.norm$Income[[1]],1)[,-2],
                          "Pre-Diabetes"=tail(BOOT.norm$Income[[2]],1)[,-2],
                          "Diabetes"=tail(BOOT.norm$Income[[3]],1)[,-2])

norm_income_kable = kable(norm_income_table, caption="Normal CI on Income",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

# Student t table
stud_income_table = rbind("No Diabetes"=tail(BOOT.stud$Income[[1]],1)[,-c(2,3)],
                          "Pre-Diabetes"=tail(BOOT.stud$Income[[2]],1)[,-c(2,3)],
                          "Diabetes"=tail(BOOT.stud$Income[[3]],1)[,-c(2,3)])

stud_income_kable = kable(stud_income_table, caption="Student-t CI on Income",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

norm_income_kable
stud_income_kable
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
income.norm = rbind(cbind("Diabetes"=rep(0,251),"Income"=BOOT.norm[["Income"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"Income"=BOOT.norm[["Income"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"Income"=BOOT.norm[["Income"]][[3]]$mean))
income.norm = as.data.frame(income.norm)
income.norm$Diabetes = as.factor(income.norm$Diabetes)

income_norm_plot = ggplot() +
  geom_histogram(aes(x=income.norm$Income, y=..count../sum(..count..)*100,
                     fill=income.norm$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=norm_income_table$lower, xend=norm_income_table$upper,
                   y=seq(0.5, 4, length.out=3), yend=seq(0.5, 4, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Normal CI on Income", x="Income", y="Frequency", fill="Diabetes")

#########################
income.stud = rbind(cbind("Diabetes"=rep(0,251),"Income"=BOOT.stud[["Income"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"Income"=BOOT.stud[["Income"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"Income"=BOOT.stud[["Income"]][[3]]$mean))
income.stud = as.data.frame(income.stud)
income.stud$Diabetes = as.factor(income.stud$Diabetes)

income_stud_plot = ggplot() +
  geom_histogram(aes(x=income.stud$Income, y=..count../sum(..count..)*100,
                     fill=income.stud$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=stud_income_table$lower, xend=stud_income_table$upper,
                   y=seq(1,6, length.out=3), yend=seq(1,6, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Student t CI on Income", x="Income", y="Frequency", fill="Diabetes")

income_norm_plot + income_stud_plot + plot_layout(ncol = 2, guides = "collect")
```

## BMI

```{r echo=FALSE, message=FALSE, warning=FALSE}
### Tables for m=250, n=250 ###
# Normal CI table
norm_BMI_table = rbind("No Diabetes"=tail(BOOT.norm$BMI[[1]],1)[,-2],
                          "Pre-Diabetes"=tail(BOOT.norm$BMI[[2]],1)[,-2],
                          "Diabetes"=tail(BOOT.norm$BMI[[3]],1)[,-2])

norm_BMI_kable = kable(norm_BMI_table, caption="Normal CI on BMI",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

# Student t table
stud_BMI_table = rbind("No Diabetes"=tail(BOOT.stud$BMI[[1]],1)[,-c(2,3)],
                          "Pre-Diabetes"=tail(BOOT.stud$BMI[[2]],1)[,-c(2,3)],
                          "Diabetes"=tail(BOOT.stud$BMI[[3]],1)[,-c(2,3)])

stud_BMI_kable = kable(stud_BMI_table, caption="Student-t CI on BMI",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

norm_BMI_kable
stud_BMI_kable
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
BMI.norm = rbind(cbind("Diabetes"=rep(0,251),"BMI"=BOOT.norm[["BMI"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"BMI"=BOOT.norm[["BMI"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"BMI"=BOOT.norm[["BMI"]][[3]]$mean))
BMI.norm = as.data.frame(BMI.norm)
BMI.norm$Diabetes = as.factor(BMI.norm$Diabetes)

BMI_norm_plot = ggplot() +
  geom_histogram(aes(x=BMI.norm$BMI, y=..count../sum(..count..)*100,
                     fill=BMI.norm$Diabetes), position="identity",bins=35) +
  geom_segment(aes(x=norm_BMI_table$lower, xend=norm_BMI_table$upper,
                   y=seq(1, 7, length.out=3), yend=seq(1, 7, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Normal CI on BMI", x="BMI", y="Frequency", fill="Diabetes")

#########################
BMI.stud = rbind(cbind("Diabetes"=rep(0,251),"BMI"=BOOT.stud[["BMI"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"BMI"=BOOT.stud[["BMI"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"BMI"=BOOT.stud[["BMI"]][[3]]$mean))
BMI.stud = as.data.frame(BMI.stud)
BMI.stud$Diabetes = as.factor(BMI.stud$Diabetes)

BMI_stud_plot = ggplot() +
  geom_histogram(aes(x=BMI.stud$BMI, y=..count../sum(..count..)*100,
                     fill=BMI.stud$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=stud_BMI_table$lower, xend=stud_BMI_table$upper,
                   y=seq(1, 10, length.out=3), yend=seq(1, 10, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Student t CI on BMI", x="BMI", y="Frequency", fill="Diabetes")

BMI_norm_plot + BMI_stud_plot + plot_layout(ncol = 2, guides = "collect")
```

## GenHlth

```{r echo=FALSE, message=FALSE, warning=FALSE}
### Tables for m=250, n=250 ###
# Normal CI table
norm_GenHlth_table = rbind("No Diabetes"=tail(BOOT.norm$GenHlth[[1]],1)[,-2],
                          "Pre-Diabetes"=tail(BOOT.norm$GenHlth[[2]],1)[,-2],
                          "Diabetes"=tail(BOOT.norm$GenHlth[[3]],1)[,-2])

norm_GenHlth_kable = kable(norm_GenHlth_table, caption="Normal CI on GenHlth",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

# Student t table
stud_GenHlth_table = rbind("No Diabetes"=tail(BOOT.stud$GenHlth[[1]],1)[,-c(2,3)],
                          "Pre-Diabetes"=tail(BOOT.stud$GenHlth[[2]],1)[,-c(2,3)],
                          "Diabetes"=tail(BOOT.stud$GenHlth[[3]],1)[,-c(2,3)])

stud_GenHlth_kable = kable(stud_GenHlth_table, caption="Student-t CI on GenHlth",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

norm_GenHlth_kable
stud_GenHlth_kable
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
GenHlth.norm = rbind(cbind("Diabetes"=rep(0,251),"GenHlth"=BOOT.norm[["GenHlth"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"GenHlth"=BOOT.norm[["GenHlth"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"GenHlth"=BOOT.norm[["GenHlth"]][[3]]$mean))
GenHlth.norm = as.data.frame(GenHlth.norm)
GenHlth.norm$Diabetes = as.factor(GenHlth.norm$Diabetes)

GenHlth_norm_plot = ggplot() +
  geom_histogram(aes(x=GenHlth.norm$GenHlth, y=..count../sum(..count..)*100,
                     fill=GenHlth.norm$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=norm_GenHlth_table$lower, xend=norm_GenHlth_table$upper,
                   y=seq(1, 6, length.out=3), yend=seq(1, 6, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Normal CI on GenHlth", x="GenHlth", y="Frequency", fill="Diabetes")

#########################
GenHlth.stud = rbind(cbind("Diabetes"=rep(0,251),"GenHlth"=BOOT.stud[["GenHlth"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"GenHlth"=BOOT.stud[["GenHlth"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"GenHlth"=BOOT.stud[["GenHlth"]][[3]]$mean))
GenHlth.stud = as.data.frame(GenHlth.stud)
GenHlth.stud$Diabetes = as.factor(GenHlth.stud$Diabetes)

GenHlth_stud_plot = ggplot() +
  geom_histogram(aes(x=GenHlth.stud$GenHlth, y=..count../sum(..count..)*100,
                     fill=GenHlth.stud$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=stud_GenHlth_table$lower, xend=stud_GenHlth_table$upper,
                   y=seq(1, 6, length.out=3), yend=seq(1, 6, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Student t CI on GenHlth", x="GenHlth", y="Frequency", fill="Diabetes")

GenHlth_norm_plot + GenHlth_stud_plot + plot_layout(ncol = 2, guides = "collect")
```

## HighBP

```{r echo=FALSE, message=FALSE, warning=FALSE}
### Tables for m=250, n=250 ###
# Normal CI table
norm_HighBP_table = rbind("No Diabetes"=tail(BOOT.norm$HighBP[[1]],1)[,-2],
                          "Pre-Diabetes"=tail(BOOT.norm$HighBP[[2]],1)[,-2],
                          "Diabetes"=tail(BOOT.norm$HighBP[[3]],1)[,-2])

norm_HighBP_kable = kable(norm_HighBP_table, caption="Normal CI on HighBP",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

# Student t table
stud_HighBP_table = rbind("No Diabetes"=tail(BOOT.stud$HighBP[[1]],1)[,-c(2,3)],
                          "Pre-Diabetes"=tail(BOOT.stud$HighBP[[2]],1)[,-c(2,3)],
                          "Diabetes"=tail(BOOT.stud$HighBP[[3]],1)[,-c(2,3)])

stud_HighBP_kable = kable(stud_HighBP_table, caption="Student-t CI on HighBP",
                          digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

norm_HighBP_kable
stud_HighBP_kable
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
HighBP.norm = rbind(cbind("Diabetes"=rep(0,251),"HighBP"=BOOT.norm[["HighBP"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"HighBP"=BOOT.norm[["HighBP"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"HighBP"=BOOT.norm[["HighBP"]][[3]]$mean))
HighBP.norm = as.data.frame(HighBP.norm)
HighBP.norm$Diabetes = as.factor(HighBP.norm$Diabetes)

HighBP_norm_plot = ggplot() +
  geom_histogram(aes(x=HighBP.norm$HighBP, y=..count../sum(..count..)*100,
                     fill=HighBP.norm$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=norm_HighBP_table$lower, xend=norm_HighBP_table$upper,
                   y=seq(1, 8, length.out=3), yend=seq(1, 8, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Normal CI on HighBP", fill="Diabetes",
       x="HighBP", y="Frequency")

#########################
HighBP.stud = rbind(cbind("Diabetes"=rep(0,251),"HighBP"=BOOT.stud[["HighBP"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),"HighBP"=BOOT.stud[["HighBP"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),"HighBP"=BOOT.stud[["HighBP"]][[3]]$mean))
HighBP.stud = as.data.frame(HighBP.stud)
HighBP.stud$Diabetes = as.factor(HighBP.stud$Diabetes)

HighBP_stud_plot = ggplot() +
  geom_histogram(aes(x=HighBP.stud$HighBP, y=..count../sum(..count..)*100,
                     fill=HighBP.stud$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=stud_HighBP_table$lower, xend=stud_HighBP_table$upper,
                   y=seq(1, 8, length.out=3), yend=seq(1, 8, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Student-t CI on HighBP", fill="Diabetes",
       x="HighBP", y="Frequency")

HighBP_norm_plot + HighBP_stud_plot + plot_layout(ncol = 2, guides = "collect")
```

## AnyHealthcare

```{r echo=FALSE, message=FALSE, warning=FALSE}
### Tables for m=250, n=250 ###
# Normal CI table
norm_AnyHealthcare_table = rbind("No Diabetes"=tail(BOOT.norm$AnyHealthcare[[1]],1)[,-2],
                          "Pre-Diabetes"=tail(BOOT.norm$AnyHealthcare[[2]],1)[,-2],
                          "Diabetes"=tail(BOOT.norm$AnyHealthcare[[3]],1)[,-2])

norm_AnyHealthcare_kable = kable(norm_AnyHealthcare_table,
                                 caption="Normal CI on AnyHealthcare",
                                 digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

# Student t table
stud_AnyHealthcare_table = rbind("No Diabetes"=tail(BOOT.stud$AnyHealthcare[[1]],1)[,-c(2,3)],
                          "Pre-Diabetes"=tail(BOOT.stud$AnyHealthcare[[2]],1)[,-c(2,3)],
                          "Diabetes"=tail(BOOT.stud$AnyHealthcare[[3]],1)[,-c(2,3)])

stud_AnyHealthcare_kable = kable(stud_AnyHealthcare_table,
                                 caption="Student-t CI on AnyHealthcare",
                                 digits=3, format = "html") %>%
      kable_styling("striped", full_width=F, position="float_left", font_size=10) %>%
      row_spec(0, bold = TRUE, font_size=14, align="c") %>% row_spec(0:3, align="c") %>%
      column_spec(1, bold = TRUE, border_right = TRUE, width = "7em")

norm_AnyHealthcare_kable
stud_AnyHealthcare_kable
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
AnyHealthcare.norm = rbind(cbind("Diabetes"=rep(0,251),
                                 "AnyHealthcare"=BOOT.norm[["AnyHealthcare"]][[1]]$mean),
                    cbind("Diabetes"=rep(1,251),
                          "AnyHealthcare"=BOOT.norm[["AnyHealthcare"]][[2]]$mean),
                    cbind("Diabetes"=rep(2,251),
                          "AnyHealthcare"=BOOT.norm[["AnyHealthcare"]][[3]]$mean))
AnyHealthcare.norm = as.data.frame(AnyHealthcare.norm)
AnyHealthcare.norm$Diabetes = as.factor(AnyHealthcare.norm$Diabetes)

AnyHealthcare_norm_plot = ggplot() +
  geom_histogram(aes(x=AnyHealthcare.norm$AnyHealthcare, y=..count../sum(..count..)*100,
                     fill=AnyHealthcare.norm$Diabetes), position="identity", bins=35) +
  geom_segment(aes(x=norm_AnyHealthcare_table$lower, xend=norm_AnyHealthcare_table$upper,
                   y=seq(1, 15, length.out=3), yend=seq(1, 15, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Normal CI on AnyHealthcare", fill="Diabetes",
       x="AnyHealthcare", y="Frequency")

#########################
AnyHealthcare.stud = rbind(cbind("Diabetes"=rep(0,251),
                                 "AnyHealthcare"=BOOT.stud[["AnyHealthcare"]][[1]]$mean),
                           cbind("Diabetes"=rep(1,251),
                                 "AnyHealthcare"=BOOT.stud[["AnyHealthcare"]][[2]]$mean),
                           cbind("Diabetes"=rep(2,251),
                                 "AnyHealthcare"=BOOT.stud[["AnyHealthcare"]][[3]]$mean))
AnyHealthcare.stud = as.data.frame(AnyHealthcare.stud)
AnyHealthcare.stud$Diabetes = as.factor(AnyHealthcare.stud$Diabetes)

AnyHealthcare_stud_plot = ggplot() +
  geom_histogram(aes(x=AnyHealthcare.stud$AnyHealthcare, y=..count../sum(..count..)*100,
                     fill=AnyHealthcare.stud$Diabetes),
                 position="identity", bins=35) +
  geom_segment(aes(x=stud_AnyHealthcare_table$lower, xend=stud_AnyHealthcare_table$upper,
                   y=seq(1, 15, length.out=3), yend=seq(1, 15, length.out=3)),
               color=c("red", "green","blue"), fill="black", size=1) +
  labs(title="Student-t CI on AnyHealthcare", fill="Diabetes",
       x="AnyHealthcare", y="Frequency")

AnyHealthcare_norm_plot + AnyHealthcare_stud_plot + plot_layout(ncol = 2, guides = "collect")
```


# Cadeon